<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Chemistry Board Game ‚Äì George, Angie, Kobe, Walter, Alexander</title>
<style>
  :root{
    --ink:#121212; --good:#4caf50; --bad:#e74c3c; --panel:#ffffffcc;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    background:#ede7e3;
    font-family:"Poppins", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:flex-start;
    padding:18px;
    padding-bottom:120px;
  }

  /* --- Board container with your Canva board image --- */
  .board-wrap{
    position:relative;
    width:min(1200px, 95vw);
    aspect-ratio: 16 / 9;
    background:#f7f4f1;
    border-radius:16px;
    overflow:hidden;
    box-shadow:0 12px 40px #00000020;
    margin-bottom:100px; /* space for HUD */
  }

  .board-bg{
    position:absolute; inset:0;
    background:url('board.png') center / contain no-repeat;
    z-index:1;
  }

  /* --- Center dice --- */
  .dice{
    position:absolute; inset:0; margin:auto;
    width:min(18vmin,140px); height:min(18vmin,140px);
    border-radius:22px; background:#cc6b6b; color:#fff;
    display:grid; place-items:center;
    font-weight:900; font-size:42px;
    cursor:pointer; user-select:none;
    box-shadow:inset 0 -8px 0 #00000025, 0 10px 25px #00000025;
    transition: transform .08s ease-in-out, rotate .4s ease;
    z-index:5;
  }
  .dice:active{ transform: scale(.98) }
  .roll-hint{ position:absolute; left:50%; top:56%; transform:translateX(-50%); font-size:14px; background:#ffffffcc; padding:4px 10px; border-radius:999px }

  /* --- Tokens --- */
  .token{
    position:absolute;
    width:26px; height:26px;
    border-radius:50%;
    border:2px solid #000;
    transform:translate(-50%,-50%);
    transition:left .35s ease, top .35s ease;
    z-index:5;
    box-shadow:0 2px 5px #00000040;
  }
  .p1{background:#ff5d5d}
  .p2{background:#5d9bff}
  .p3{background:#50d890}
  .p4{background:#ffd166}
  .p5{background:#b07aff}

  /* --- HUD below the board --- */
  .hud{
    display:flex;
    flex-wrap:wrap;
    justify-content:center;
    gap:12px;
    position:relative;
    bottom:0;
  }
  .panel{
    background:var(--panel);
    backdrop-filter:blur(4px);
    border:1px solid #00000018;
    border-radius:12px;
    padding:10px 14px;
    box-shadow:0 8px 24px #00000020;
  }
  .row{display:flex; gap:8px; align-items:center; flex-wrap:wrap}
  .btn{border:0; border-radius:10px; padding:8px 14px; font-weight:700; cursor:pointer; background:#111; color:#fff}
  .btn.alt{background:#fff; color:#111; border:2px solid #00000022}

  /* --- Modal for questions/reactions --- */
  .modal{position:fixed; inset:0; background:#00000066; display:none; align-items:center; justify-content:center; z-index:50; padding:18px}
  .modal.show{display:flex}
  .dialog{background:#fff; width:min(720px, 95vw); border-radius:16px; border:2px solid #00000020; padding:18px}
  .dialog h2{margin:0 0 8px 0}
  .options{display:grid; gap:10px; margin-top:10px}
  .optBtn{border:2px solid #00000020; border-radius:12px; background:#fff; padding:12px; text-align:left; font-weight:700; cursor:pointer}
  .optBtn:hover{border-color:#00000045}
  .banner{padding:10px 12px; border-radius:12px; color:#fff; font-weight:800}
  .good{background:var(--good)} .bad{background:var(--bad)}

  /* turn / score chips */
  .chip{border-radius:999px; padding:4px 10px; background:#00000010; font-weight:700}
  .chip.dark{background:#111; color:#fff}

  @media (max-width:780px){ .row{justify-content:center} }
</style>
</head>
<body>

<div class="board-wrap" id="board">
  <div class="board-bg" aria-hidden="true"></div>

  <!-- Center dice -->
  <div id="dice" class="dice" title="Roll">üé≤</div>
  <div class="roll-hint" id="rollHint">Tap dice to roll</div>

  <!-- Player tokens (absolute, positioned by JS) -->
  <div id="t1" class="token George"></div>
  <div id="t2" class="token Angie"></div>
  <div id="t3" class="token Kobe"></div>
  <div id="t4" class="token Walter"></div>
  <div id="t5" class="token Alexander"></div>
</div>

<!-- HUD BELOW BOARD -->
<div class="hud">
  <div class="panel">
    <div class="row" style="gap:6px">
      <b>Players:</b>
      <select id="playerCount" class="btn alt" style="padding:6px 10px">
        <option>2</option><option>3</option><option>4</option><option selected>5</option>
      </select>
      <button id="apply" class="btn">Apply</button>
      <button id="reset" class="btn alt">Restart</button>
    </div>
  </div>
  <div class="panel">
    <div class="row" style="gap:12px">
      <span class="chip dark" id="turnChip">Turn: ‚Äì</span>
      <span class="chip" id="rollChip">Roll to start</span>
    </div>
    <div id="scores" class="row" style="margin-top:8px"></div>
  </div>
</div>

<!-- Modal -->
<div id="modal" class="modal"><div class="dialog"><div id="modalContent"></div></div></div>

<script>
/* ===========================================================
   GAME DATA + PATH
=========================================================== */

const BOARD = [
  {type:'start', label:'START'},
  {type:'finish', label:'FINISH'},
  {type:'reaction', text:'Catalyst speeds up reaction ‚Äî move ahead 2 spaces.', effect:{move:+2}},
  {type:'reaction', text:'Element found in meteorite sample ‚Äî +5 points.', effect:{points:+5}},
  {type:'reaction', text:'Fake element reported ‚Äî lose 2 points for bad data.', effect:{points:-2}},
  {type:'reaction', text:'Give an example of a simple present sentence using ‚Äúusually.‚Äù', teacher:true},
  {type:'reaction', text:'What happens to the verb ‚Äúcry‚Äù in third person singular? (‚Äúcries‚Äù)', teacher:true},
  {type:'reaction', text:'Say a negative sentence in the simple present about food.', teacher:true},
  {type:'reaction', text:'Correct! +2 points.', effect:{points:+2}},
  {type:'reaction', text:'Wrong! -1 point.', effect:{points:-1}},
  {type:'reaction', text:'Jail Time ‚Äî lose next turn.', effect:{skip:1}},
  {type:'reaction', text:'All point taken ‚Äî +3 points.', effect:{points:+3}},
  {type:'question', q:'Pure water has a pH of 7. It is:', choices:['Acidic','Basic','Neutral','Corrosive'], answer:'C', points:{correct:2, wrong:-1}},
  {type:'question', q:'Which bond shares electrons?', choices:['Ionic','Hydrogen','Covalent','Metallic'], answer:'C', points:{correct:2, wrong:-1}},
  {type:'reaction', text:'Lucky ‚Äî +1 point.', effect:{points:+1}},
  {type:'reaction', text:'Elemental boost ‚Äî move ahead 1 space.', effect:{move:+1}},
  {type:'reaction', text:'Stable reaction ‚Äî nothing happens.'},
  {type:'reaction', text:'Volatile reaction ‚Äî lose 1 point.', effect:{points:-1}},
  {type:'reaction', text:'Perfect synthesis ‚Äî +4 points.', effect:{points:+4}},
  {type:'reaction', text:'Jail release ‚Äî skip penalty removed.', effect:{skip:-1}},
];

/* Approximate perimeter path (clockwise) */
function buildPath(){
  const coords = [];
  // bottom row (left to right)
  for(let i=0;i<6;i++) coords.push({x:8+15*i, y:90});
  // right side (bottom ‚Üí top)
  for(let i=1;i<5;i++) coords.push({x:90, y:90-18*i});
  // top row (right ‚Üí left)
  for(let i=1;i<6;i++) coords.push({x:90-15*i, y:10});
  // left side (top ‚Üí bottom)
  for(let i=1;i<4;i++) coords.push({x:8, y:10+20*i});
  return coords.slice(0, BOARD.length);
}
const PATH = buildPath();

let players = [], current=0, locked=false;
const boardEl=document.getElementById('board');
const diceEl=document.getElementById('dice');
const rollHint=document.getElementById('rollHint');
const scoresRow=document.getElementById('scores');
const turnChip=document.getElementById('turnChip');
const rollChip=document.getElementById('rollChip');
document.getElementById('apply').onclick=()=>boot(Number(document.getElementById('playerCount').value||5));
document.getElementById('reset').onclick=()=>boot(Number(document.getElementById('playerCount').value||5));

function boot(n=5){
  players=Array.from({length:n},(_,i)=>({pos:0,score:0,skip:0,token:document.getElementById('t'+(i+1))}));
  for(let i=0;i<5;i++){
    const t=document.getElementById('t'+(i+1));
    t.style.display=i<n?'block':'none';
  }
  players.forEach((p,i)=>placeToken(p,0,tokenNudge(i)));
  current=0; renderScores(); updateTurn();
}
function renderScores(){
  scoresRow.innerHTML='';
  players.forEach((p,i)=>{
    const chip=document.createElement('span');
    chip.className='chip';
    chip.innerHTML=`<b>Player ${i+1}</b>: <span id="sc${i}">${p.score}</span> pts ¬∑ Space <span id="sp${i}">${p.pos}</span>`;
    scoresRow.appendChild(chip);
  });
}
function updateTurn(){ turnChip.textContent=`Turn: Player ${current+1}`; }
function placeToken(player,idx,nudge={dx:0,dy:0}){
  const {x,y}=PATH[idx];
  player.token.style.left=`${x}%`;
  player.token.style.top=`${y}%`;
  player.token.style.transform=`translate(-50%,-50%) translate(${nudge.dx}px,${nudge.dy}px)`;
}
function tokenNudge(i){return[{dx:-6,dy:-6},{dx:+6,dy:-6},{dx:+6,dy:+6},{dx:-6,dy:+6},{dx:0,dy:0}][i%5];}

diceEl.addEventListener('click',()=>{
  if(locked||players.length===0)return;
  const p=players[current];
  if(p.skip>0){p.skip--;toast(`Player ${current+1} skips this turn.`);nextTurn();return;}
  locked=true;rollHint.style.display='none';
  const roll=Math.floor(Math.random()*6)+1;
  diceEl.textContent=roll;rollChip.textContent=`Rolled ${roll}`;
  let steps=roll;
  const stepper=setInterval(()=>{
    if(steps<=0){clearInterval(stepper);landed();return;}
    p.pos=Math.min(p.pos+1,BOARD.length-1);
    document.getElementById('sp'+current).textContent=p.pos;
    placeToken(p,p.pos,tokenNudge(current));
    steps--;
  },250);
});

function landed(){
  const tile=BOARD[players[current].pos];
  if(!tile){locked=false;nextTurn();return;}
  if(tile.type==='question'){showQuestion(tile);return;}
  if(tile.type==='reaction'){applyReaction(tile);return;}
  if(tile.type==='finish'){toast(`üéâ Player ${current+1} reached FINISH! (+3 pts)`);deltaScore(current,+3);locked=false;nextTurn();return;}
  locked=false;nextTurn();
}

function deltaScore(i,n){players[i].score+=n;document.getElementById('sc'+i).textContent=players[i].score;}
function nextTurn(){current=(current+1)%players.length;updateTurn();}

/* --- Modal Logic --- */
const modal=document.getElementById('modal');
const modalContent=document.getElementById('modalContent');
function openModal(html){modalContent.innerHTML=html;modal.classList.add('show');}
function closeModal(){modal.classList.remove('show');}
modal.addEventListener('click',(e)=>{if(e.target===modal)closeModal();});

function toast(text){
  openModal(`<div class="banner" style="background:#111">${text}</div>
  <div style="text-align:right;margin-top:10px"><button class="btn" id="ok">OK</button></div>`);
  modal.querySelector('#ok').addEventListener('click',()=>closeModal());
}

function showQuestion(tile){
  const letters=['A','B','C','D'];
  const opts=tile.choices.map((t,idx)=>`<button class="optBtn" data-k="${letters[idx]}"><b>${letters[idx]}.</b> ${t}</button>`).join('');
  openModal(`<h2>Question</h2><div style="font-size:18px">${tile.q}</div><div class="options">${opts}</div>`);
  modal.querySelectorAll('.optBtn').forEach(btn=>{
    btn.addEventListener('click',e=>{
      const k=e.currentTarget.getAttribute('data-k');
      const correct=tile.answer;
      if(k===correct){
        const gain=tile.points?.correct??2;
        deltaScore(current,gain);
        openModal(`<div class="banner good">‚úÖ Correct! +${gain} pts</div><div style="text-align:right;margin-top:10px"><button class="btn" id="go">Continue</button></div>`);
      }else{
        const loss=tile.points?.wrong??-1;
        deltaScore(current,loss);
        openModal(`<div class="banner bad">‚ùå Wrong. ${loss} pt</div><div style="text-align:right;margin-top:10px"><button class="btn" id="go">Continue</button></div>`);
      }
      modal.querySelector('#go').addEventListener('click',()=>{closeModal();locked=false;nextTurn();});
    });
  });
}

function applyReaction(tile){
  if(tile.teacher){
    openModal(`<h2>Reaction</h2><div style="font-size:18px">${tile.text}</div>
      <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:12px">
        <button class="btn alt" id="no">Mark Wrong (‚àí1)</button>
        <button class="btn" id="yes">Mark Correct (+2)</button>
      </div>`);
    modal.querySelector('#yes').addEventListener('click',()=>{deltaScore(current,+2);closeModal();locked=false;nextTurn();});
    modal.querySelector('#no').addEventListener('click',()=>{deltaScore(current,-1);closeModal();locked=false;nextTurn();});
    return;
  }
  let msg=tile.text||'Event';
  const eff=tile.effect||{};
  if(eff.points){deltaScore(current,eff.points);msg+=` (${eff.points>0?'+':''}${eff.points} pts)`;}
  if(eff.move){
    const p=players[current];
    p.pos=Math.min(p.pos+eff.move,BOARD.length-1);
    document.getElementById('sp'+current).textContent=p.pos;
    placeToken(p,p.pos,tokenNudge(current));
    msg+=` (moved ${eff.move>0?'+':''}${eff.move})`;
  }
  if(eff.skip){players[current].skip+=eff.skip;msg+=` (skip next ${eff.skip})`;}
  openModal(`<h2>Reaction</h2><div style="font-size:18px">${msg}</div>
    <div style="text-align:right;margin-top:10px"><button class="btn" id="ok">Continue</button></div>`);
  modal.querySelector('#ok').addEventListener('click',()=>{closeModal();locked=false;nextTurn();});
}

window.addEventListener('resize',()=>players.forEach((p,i)=>placeToken(p,p.pos,tokenNudge(i))));
boot(5);
players.forEach((p,i)=>placeToken(p,0,tokenNudge(i)));
</script>
</body>
</html>

